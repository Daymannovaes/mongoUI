<!DOCTYPE HTML>
<html> 
<head>
	<title>Mongo User Iterface</title>

	<!-- Bootstrap -->
	<link href="css/bootstrap.css" rel="stylesheet">
	<script type="text/javascript" src="js/angular.js"></script>
	<script type="text/javascript" src="js/script.js"></script>
	<script type="text/javascript" src="js/jquery-1.11.0.min.js"></script>


</head>
<body data-ng-app>
	<!-- top fixed nav bar -->
	<nav data-ng-include="src='html/navbar-header.html'"
	class=" navbar navbar-default navbar-fixed-top" role="navigation">
		Loading navbar...
	</nav>

	<div data-ng-controller="collectionController" class="container" style="">
		<!-- Collections and fields -->
		<div class="col-md-4" style="border:;">

			<!-- Collections -->
			<div class="row" style="border:;">
				<div class="col-md-8"> 			
					<select class="form-control" style="" data-ng-model="currentCollection"
					data-ng-options="collection as collection.name for collection in collections" data-ng-change="loadFields()">
						<option value="">Collections</option>
					</select>
				</div>
				<div class="col-md-4">
					<input class="btn" type="button" data-ng-click="showCollections()" value="show collections" />
				</div>
			</div> <!-- end c -->

			<!-- Fields -->
			<div class="row" style="border:;">
				<form data-ng-show="showFields">
					<div class="form-group" data-ng-repeat="(key, value) in currentCollection.fields">
						<label for={{key}}>{{key}}</label>
						<input data-ng-model="currentCollection.fields[key]" class="form-control" type="text"
						placeholder={{currentCollection.name}}.{{key}}
						name={{key}}
						id="{{currentCollection.name}}_{{key}}" /> 
					</div>

					<!-- new field -->
					<div class="row" data-ng-show="showNewField">
						<div class="form-group">
							<div class="col-md-10">
								<input data-ng-model="newFieldName" class="form-control" type="text"/> 
							</div>
							<div class="col-md-2">
								<input class="btn" type="button" value="+" data-ng-click="addField()" /> 
							</div>
						</div>
					</div>

					<input class="btn" type="submit" data-ng-click="loadData();addData()" value="Pesquisar" />
					<input class="btn" type="button" data-ng-click="showNewField = !showNewField" value="Adicionar campo" />

				</form>
			</div> <!-- end field -->
		</div> <!-- end c and f -->

		<!-- Data -->
		<div class="col-md-8" style="border:;">
			<div data-ng-include="src='recursive-data-template.html'"></div>
		</div>	
	</div>	

	<!-- old template (will be replaced) -->
	<!-- recursive template label -->
	<script type="text/ng-template" id="field_renderer.html">
		{{$index}}
		<ul>
			<li data-ng-repeat="(key, value) in document">
				{{key}}:	

				<span data-ng-if="typeOf(value) != 'object'">{{value}}</span>

				<span data-ng-if="typeOf(value) == 'object'">
					<ul>
						<li data-ng-repeat="document in value" data-ng-include="'field_renderer.html'">
						</li>
					</ul>
				</span>
			</li>
		</ul>
		<hr>
	</script>

	<!-- Here will be the new recursive template -->
	<script type="text/ng-template" id="recursive-data-template.html">
		<div data-ng-repeat="document in data">
			<table class="table table-striped table-hover">
				<thead>
					<tr>
						<th data-ng-repeat="(key, data) in document">
							{{key}}
						</th>
					</tr>
				</thead>						
				<tr>
					<td data-ng-repeat="(key, data) in document">
						<span data-ng-if="typeOf(data) != 'object'">{{data}}</span>
						<span data-ng-if="typeOf(data) == 'object'">
							<span data-ng-click="showData=!showData">Mostrar</span>
							<div data-ng-show="showData" data-ng-include="'recursive-data-template.html'"><div>
						</span>
					</td>
				</tr>
			</table>
		</div>
	</script>
</body>
</html>